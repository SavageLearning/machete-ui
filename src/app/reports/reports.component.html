<p-card styleClass="p-card-shadow p-mb-5" header="Reports">
  <div class="p-fluid p-formgrid p-grid"> 
    <div class="p-field p-col-12 p-input-filled">
      <label for="select-report">Select a report</label>
      <p-dropdown inputId="select-report" [options]="reportsDropDown" (onChange)="getView()" [(ngModel)]="selectedReportID" [filter]="true" styleClass="p-mr-2"></p-dropdown>
    </div>
    <div *ngIf="inputs.memberNumber === true" class="p-field p-col-12 p-md-12 p-lg-4 p-input-filled">
      <label for="memberNumber">Member number</label>
      <input id="memberNumber" type="text" pInputText [(ngModel)]="o.memberNumber" (onBlur)="getView()" dataType="number"/>
    </div>
    <div *ngIf="inputs.beginDate === true" class="p-field p-col-12 p-md-12 p-lg-4 p-input-filled">
      <label for="start-date-cal">Start date</label>
      <p-calendar id="start-date-cal" placeholder="Start date" (onSelect)="getView()" (onBlur)="getView()" [(ngModel)]="o.beginDate" [showIcon]="true" dataType="string"></p-calendar>
    </div>
    <div *ngIf="inputs.endDate === true" class="p-field p-col-12 p-md-12 p-lg-4 p-input-filled">
      <label for="end-date-cal">End date</label>
      <p-calendar id="end-date-cal" placeholder="End date" (onSelect)="getView()" (onBlur)="getView()" [(ngModel)]="o.endDate" [showIcon]="true" dataType="string"></p-calendar>
    </div>
  </div>
  <ng-template pTemplate="footer">
    <!-- Responsive container -->
    <div class="p-d-flex p-flex-column p-flex-md-row">
      <div class="p-mb-2 p-mr-2">
        <button pButton pRipple type="button" icon="pi pi-refresh" tooltipPosition="bottom" label="Refresh" (click)="getView()"></button>
      </div>
    </div>
  </ng-template>
</p-card>

<p-card styleClass="p-card-shadow p-mb-5" header="Report Definitions">
  <p-inplace closable="closable" [style]="{'min-height':'33px'}">
    <ng-template pTemplate="display">
        <div class="p-d-inline-flex p-ai-center" style="color:green;">
          <span class="pi pi-table" style="vertical-align: middle; color:green;"></span>
          <span class="p-ml-2">View</span>
        </div>
    </ng-template>
    <ng-template pTemplate="content">

      <button pButton icon="pi pi-save" (click)="save()" label="Save Report Definition" class="p-mb-6 p-mt-2 p-button-raised"></button>
      
      <div class="p-fluid p-formgrid p-grid">
        <div class="p-field p-col-12 p-input-filled">
          <label for="name">Name</label>
          <input pInputText id="name" [(ngModel)]="selectedReport.name" />
        </div>
        <div class="p-field p-col-12 p-input-filled">
          <label for="commonName">Common name</label>
          <input pInputText id="commonName" [(ngModel)]="selectedReport.commonName" />
        </div>
        <div class="p-field p-col-12 p-input-filled">
          <label for="description">Description</label>
          <input pInputText id="description" [(ngModel)]="selectedReport.description" />
        </div>
        <div class="p-col-12 p-mb-6">
          <label for="sqlquery" class="p-mb-6">SQL Query</label>
          <app-editor [sql]="selectedReport.sqlquery" (editedSql)="onDoneWithSql($event)"></app-editor>
        </div>
      </div>
      <p-footer>
        <p-divider></p-divider>
      </p-footer> 
    </ng-template>
  </p-inplace>
</p-card>

<p-dialog header="{{title}}" [(visible)]="displayDescription">
  {{description}}
</p-dialog>
<div>

<p-table
  #dt
  [value]="viewData"
  sortField="value"
  sortOrder="-1"
  sortMode="single"
  [responsive]="true"
  styleClass="p-datatable-gridlines p-datatable-striped"
  [columns]="cols"
  >
  <ng-template pTemplate="caption">
    <!-- Responsive container` -->
    <div class="p-d-flex p-flex-column p-flex-md-row p-jc-between">
      <div class="p-mb-2 p-mr-2">
        <button type="button" pButton icon="pi pi-download" iconPos="left" label="CSV" (click)="getExport(dt)"></button>
      </div>
      <div class="p-mb-2 p-mr-2">
        <input class="p-ml-auto" type="text" placeholder="Global search" width="200">
      </div>
      <div class="p-mb-2 p-mr-2">
        <button class="p-ml-auto" pButton type="button" icon="ui-icon-help-outline" (click)="showDescription()" iconPos="left"></button>
      </div>
    </div>

  </ng-template>
  <ng-template pTemplate="header">
    <tr>
        <th *ngFor="let col of cols">
            {{col.header}}
        </th>
    </tr>
  </ng-template>

  <ng-template pTemplate="body" let-viewData>
    <tr>
        <td *ngFor="let col of cols">
                {{viewData[col.field]}}
        </td>
    </tr>
  </ng-template>
</p-table>
</div>
