<p-card styleClass="p-card-shadow p-mb-5" header="Reports">
  <div class="p-fluid p-formgrid p-grid"> 
    <div class="p-field p-col-12 p-input-filled">
      <label for="select-report">Select a report</label>
      <p-dropdown inputId="select-report" [options]="reportsDropDown" (onChange)="getView()" [(ngModel)]="selectedReportID" [filter]="true" styleClass="p-mr-2"></p-dropdown>
    </div>
    <div *ngIf="inputs.memberNumber === true" class="p-field p-col-12 p-md-12 p-lg-4 p-input-filled">
      <label for="memberNumber">Member number</label>
      <input id="memberNumber" type="text" pInputText [(ngModel)]="o.memberNumber" (onBlur)="getView()" dataType="number"/>
    </div>
    <div *ngIf="inputs.beginDate === true" class="p-field p-col-12 p-md-12 p-lg-4 p-input-filled">
      <label for="start-date-cal">Start date</label>
      <p-calendar id="start-date-cal" placeholder="Start date" (onSelect)="getView()" (onBlur)="getView()" [(ngModel)]="o.beginDate" [showIcon]="true" dataType="string"></p-calendar>
    </div>
    <div *ngIf="inputs.endDate === true" class="p-field p-col-12 p-md-12 p-lg-4 p-input-filled">
      <label for="end-date-cal">End date</label>
      <p-calendar id="end-date-cal" placeholder="End date" (onSelect)="getView()" (onBlur)="getView()" [(ngModel)]="o.endDate" [showIcon]="true" dataType="string"></p-calendar>
    </div>
  </div>
  <ng-template pTemplate="footer">
    <!-- Responsive container -->
    <div class="p-d-flex p-flex-column p-flex-md-row">
      <div class="p-mb-2 p-mr-2">
        <button pButton pRipple type="button" icon="pi pi-refresh" tooltipPosition="bottom" label="Refresh" (click)="getView()"></button>
      </div>
      <div class="p-mb-2 p-mr-2">
        <button pButton pRipple type="button" icon="pi pi-pencil" tooltipPosition="bottom" label="Edit" (click)="displayDialog=true"></button>
      </div>
    </div>
  </ng-template>
</p-card>

<p-dialog header="{{title}}" [(visible)]="displayDescription">
  {{description}}
</p-dialog>
<div>

<p-table
  #dt
  [value]="viewData"
  sortField="value"
  sortOrder="-1"
  sortMode="single"
  [responsive]="true"
  styleClass="p-datatable-gridlines p-datatable-striped"
  [columns]="cols"
  >
  <ng-template pTemplate="caption">
    <!-- Responsive container` -->
    <div class="p-d-flex p-flex-column p-flex-md-row p-jc-between">
      <div class="p-mb-2 p-mr-2">
        <button type="button" pButton icon="pi pi-download" iconPos="left" label="CSV" (click)="getExport(dt)"></button>
      </div>
      <div class="p-mb-2 p-mr-2">
        <input class="p-ml-auto" type="text" placeholder="Global search" width="200">
      </div>
      <div class="p-mb-2 p-mr-2">
        <button class="p-ml-auto" pButton type="button" icon="ui-icon-help-outline" (click)="showDescription()" iconPos="left"></button>
      </div>
    </div>

  </ng-template>
  <ng-template pTemplate="header">
    <tr>
        <th *ngFor="let col of cols">
            {{col.header}}
        </th>
    </tr>
  </ng-template>

  <ng-template pTemplate="body" let-viewData>
    <tr>
        <td *ngFor="let col of cols">
                {{viewData[col.field]}}
        </td>
    </tr>
  </ng-template>
</p-table>
<p-dialog
  header="Report Details"
  [(visible)]="displayDialog"
  [responsive]="true"
  showEffect="fade"
  [modal]="false"
  [resizable]="true"
  [maximizable]="true"
  [baseZIndex]="10000"
  [style]="{width: '90vw'}"
  [closeOnEscape]="true"
  (onShow)="collapseSyntaxFeedback=true"
>
<div class="card">
  <div class="p-fluid p-formgrid p-grid">
    <div class="p-field p-col-12 p-input-filled">
      <label for="name">Name</label>
      <input pInputText id="name" [(ngModel)]="name" />
    </div>
    <div class="p-field p-col-12 p-input-filled">
      <label for="commonName">Common name</label>
      <input pInputText id="commonName" [(ngModel)]="selectedReport.commonName" />
    </div>
    <div class="p-field p-col-12 p-input-filled">
      <label for="description">Description</label>
      <input pInputText id="description" [(ngModel)]="selectedReport.description" />
    </div>
    <div class="p-field p-col-12">
      <p-dialog [(visible)]="this.showSqlSyntaxHelp">
        Use this syntax highlighting to help validate the sql query. 
        The syntax only highlights SQL keywords.
        Please note that it does not highlight table or column names.
        Depending on the query, you will have the following variables for filtering:
        <pre><code>@endDate</code></pre>
        <pre><code>@beginDate</code></pre>
        <pre><code>@dwccardnum</code></pre>

      </p-dialog>
      <p-panel [toggleable]="true" [(collapsed)]="collapseSyntaxFeedback">
        <p-header>SQL Syntax Highlighting</p-header>
          <ng-template pTemplate="icons">
            <button pButton class="p-panel-header-icon p-link" icon="pi pi-copy" (click)="copyInputMessage(inputSql)"></button>
            <button pButton class="p-panel-header-icon p-link" icon="pi pi-question" (click)="showSqlSyntaxHelp=true"></button>
          </ng-template>
          <pre><code id="sqlHighlight" [highlight]="selectedReport.sqlquery" [lineNumbers]="true"></code></pre>
      </p-panel>      
    </div>
    <div class="p-field p-col-12 p-input-filled">
      <label for="sqlquery">SQL Query</label>
      <textarea #inputSql pInputTextarea  id="sqlquery" [(ngModel)]="selectedReport.sqlquery" [rows]="sqlStringRowCount" [style]="{'height':'100%'}" spellcheck="false"></textarea>
    </div>
  </div>
</div>

  <!-- <p-footer>
      <button type="button" pButton icon="pi pi-save" (click)="save()" label="Save"></button>
  </p-footer>  -->
</p-dialog>
</div>
